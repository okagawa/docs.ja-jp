---
title: コード アクセス セキュリティ
description: 悪意のあるモバイルコードからコンピューターシステムを保護するのに役立つ .NET のコードアクセスセキュリティ機構について説明します。
ms.date: 03/30/2017
helpviewer_keywords:
- named permission sets, code access security
- call stacks
- malicious code
- stack walk
- security [.NET Framework], code access security
- permissions [.NET Framework], code access security
- trusted code
- mobile code security
- unmanaged code, code access security
- granting permissions, code access security
- user authentication, code access security
- code access security
ms.assetid: 859af632-c80d-4736-8d6f-1e01b09ce127
ms.openlocfilehash: 3c125e6c57ce7da459c03fc7d51fc9311fdc8e3b
ms.sourcegitcommit: 0fa2b7b658bf137e813a7f4d09589d64c148ebf5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/14/2020
ms.locfileid: "86309015"
---
# <a name="code-access-security"></a>コード アクセス セキュリティ
[!INCLUDE[net_security_note](../../../includes/net-security-note-md.md)]  
  
 複雑にリンクされた現在のコンピューター システムには、多種多様な、多くの場合は不明なソースからコードが送信されてきます。 コードは、電子メールに添付したり、ドキュメントに含めたり、インターネット経由でダウンロードしたりすることができます。 ウイルスやワームのような悪意のあるコードによってコンピューター上のデータを破損または破壊され、時間的にも金銭的にも直接の被害を受けた経験のあるユーザーは少なくありません。  
  
 最も一般的なセキュリティメカニズムでは、資格情報 (通常はパスワード) に基づいてユーザーに権限を与え、ユーザーがアクセスできるリソース (多くの場合、ディレクトリとファイル) を制限します。 しかし、この方法では対処できないさまざまな問題が存在します。たとえば、ユーザーはさまざまなソースからコードを入手しますが、中には信頼できない入手先もあります。コードに、悪意のあるコードからねらわれやすいバグがあったり、脆弱性が潜んでいる可能性もあります。また、コードがユーザーの予期しない動作をする場合もあります。 これらの結果、ユーザーが慎重で信頼できるとしても、実行したソフトウェアが悪意のあるソフトウェアやエラーを含むソフトウェアであった場合は、コンピューター システムが損害を受けたり、機密データが漏洩したりする可能性があります。 ほとんどのオペレーティングシステムのセキュリティメカニズムでは、Web ページ上のスクリプトの場合を除き、すべてのコードを実行するために信頼されている必要があります。 そのため、信頼関係のないコンピューター システム間でも、一方のシステムから送信されたコードをもう一方のシステムで安全に実行できるようにするための、幅広く適用できるセキュリティ機構が必要になります。  
  
 コンピューター システムを悪意のあるコードから簡単に保護できるようにしたり、発生元の不明なコードを安全に実行できるようにしたり、信頼されているコードを故意または過失によって露呈したセキュリティの脆弱性から保護できるようにしたりするために、.NET Framework はコード アクセス セキュリティというセキュリティ機構を提供しています。 コード アクセス セキュリティにより、コードの発生元や、そのコードの身元を示すその他の基準に基づいて、コードをさまざまなレベルで信頼できます。 また、コードに対してさまざまな信頼レベルを強制的に適用することにより、実行するために完全に信頼されていなければならないコードの数は少なくなります。 コード アクセス セキュリティを使用することで、作成したコードが悪意のあるコードやバグのあるコードによって誤用される可能性も低くなります。 コードによって実行できる一連の操作を指定できるため、開発者の責任を軽減できます。 コード アクセス セキュリティは、コードにセキュリティの脆弱性があった場合に、それによって被る可能性のある損害を最小限に抑えるためにも役立ちます。  
  
> [!NOTE]
> .NET Framework 4 のコードアクセスセキュリティに大きな変更が加えられました。 最も注目すべき変更点は[セキュリティの透過性](security-transparent-code.md)ですが、コードアクセスセキュリティに影響する重要な変更も他にもあります。 これらの変更の詳細については、「[セキュリティの変更](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes)」を参照してください。  
  
 コード アクセス セキュリティは、主にライブラリ コードと部分的に信頼されたアプリケーションに影響します。 ライブラリ開発者は、部分的に信頼されたアプリケーションによる認証されていないアクセスからコードを保護する必要があります。 部分的に信頼されたアプリケーションは、インターネットなどの外部リソースから読み込まれるアプリケーションです。 デスクトップまたはローカル イントラネットにインストールされているアプリケーションは、完全に信頼されたアプリケーションとして実行されます。 完全に信頼されたアプリケーションは、完全に信頼されているため、[セキュリティ透過的](security-transparent-code.md)としてマークされている場合を除き、コードアクセスセキュリティの影響を受けません。 完全に信頼されたアプリケーションの唯一の制限事項は、<xref:System.Security.SecurityTransparentAttribute> 属性でマークされているアプリケーションは <xref:System.Security.SecurityCriticalAttribute> 属性でマークされているコードを呼び出すことができない点です。 部分的に信頼されたアプリケーションは、コード アクセス セキュリティを適用できるように、サンドボックス (Internet Explorer など) で実行する必要があります。 アプリケーションをインターネットからダウンロードし、デスクトップから実行しようとすると、 <xref:System.NotSupportedException> "ネットワークの場所からアセンブリを読み込もうとしましたが、以前のバージョンの .NET Framework では、アセンブリがサンドボックス化された可能性があります" というメッセージが表示されます。 このリリースの .NET Framework では CAS ポリシーが既定で有効ではないため、この読み込みは危険な場合があります。" というメッセージが表示されます。 アプリケーションが信頼できることが確実な場合は、 [ \<loadFromRemoteSources> 要素](../configure-apps/file-schema/runtime/loadfromremotesources-element.md)を使用して完全信頼として実行できるようにすることができます。 サンドボックスでアプリケーションを実行する方法の詳細については、「[方法: サンドボックスで部分信頼コードを実行する](how-to-run-partially-trusted-code-in-a-sandbox.md)」を参照してください。  
  
 共通言語ランタイムに対応したマネージド コードすべては、単一コード アクセス セキュリティ呼び出しを行わない場合でも、コード アクセス セキュリティの利点を享受することになります。 詳しくは、「[コード アクセス セキュリティの基礎](code-access-security-basics.md)」をご覧ください。  
  
<a name="key_functions"></a>
## <a name="key-functions-of-code-access-security"></a>コード アクセス セキュリティの主な機能  
 コード アクセス セキュリティにより、コードがアクセスする対象を保護されたリソースと保護された操作に制限できます。 .NET Framework では、コード アクセス セキュリティは次の機能を果たします。  
  
- 各種システム リソースにアクセスするための権限や権限セットを定義する。  
  
- 呼び出し元が特定の権限を所有していることをコードから要求できるようにする。  
  
- 呼び出し元にデジタル署名があることをコード自身が要求できるようにします。これにより、特定の組織またはサイトからの呼び出し元だけが、保護されたコードを呼び出すことができます。  
  
- 呼び出し履歴上で、各呼び出し元に付与された権限を、その呼び出し元に求められる権限と比較することにより、コードに対する制限を実行時に強制する。  
  
<a name="walking_the_call_stack"></a>
## <a name="walking-the-call-stack"></a>コール スタック ウォークの実行  
 コードがリソースにアクセスしたり、操作を実行したりすることを許可されているかどうかを判断するために、ランタイムのセキュリティ システムはコール スタック ウォークを行い、コール スタック内の各呼び出し元に与えられているアクセス許可と、確認要求されているアクセス許可とを比較します。 コール スタックに、確認要求されたアクセス許可を持っていない呼び出し元があった場合は、セキュリティ例外がスローされ、アクセスは拒否されます。 スタック ウォークは、信頼レベルの低いコードが信頼レベルの高いコードを呼び出して利用し、承認されていないアクションを実行しようとする攻撃を防止できるようにするために実行します。 コードの呼び出し元すべてに対して実行時にアクセス許可を確認要求することは、確かにパフォーマンスに影響しますが、信頼レベルの低いコードによる攻撃からコードを保護できるようにするためには必要です。 パフォーマンスを最適化するために、コードの実行に必要なスタックウォークを減らすことができます。 ただし、このような場合は必ずセキュリティの弱点を公開しないようにしてください。  
  
 アセンブリ A4 のメソッドが、その呼び出し元にアクセス許可 P が与えられていることを確認要求する場合に、結果として行われるスタック ウォークを次の図に示します。  
  
 ![コードアクセスセキュリティスタックウォーク](media/slide-10a.gif "slide_10a")
  
<a name="related_topics"></a>
## <a name="related-articles"></a>関連記事
  
|Title|説明|  
|-----------|-----------------|  
|[コード アクセス セキュリティの基礎](code-access-security-basics.md)|コード アクセス セキュリティとその最も一般的な使用方法について説明します。|  
|[透過的セキュリティ コード、レベル 2](security-transparent-code-level-2.md)|.NET Framework 4 のセキュリティ透過性モデルについて説明します。|  
|[部分信頼コードからのライブラリの使用](using-libraries-from-partially-trusted-code.md)|ライブラリを有効にしてアンマネージ コードと共に使用できるようにする方法と、アンマネージ コードからライブラリを使用する方法について説明します。|  
|[セキュリティの基本概念](../../standard/security/key-security-concepts.md)|.NET Framework セキュリティ システムで使用されるさまざまな重要用語と概念について、概要を示します。|  
|[ロール ベースのセキュリティ](../../standard/security/role-based-security.md)|ロールに基づいて、セキュリティを組み込む方法について説明します。|  
|[Cryptographic Services](../../standard/security/cryptographic-services.md)|アプリケーションに暗号を組み込む方法について説明します。|
