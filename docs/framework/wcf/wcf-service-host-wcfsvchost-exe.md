---
title: WCF サービス ホスト (WcfSvcHost.exe)
description: WCF サービスホストを使用して、実装したサービスをホストし、テストします。 WCF テストクライアントまたは独自のクライアントを使用して、サービスをテストできます。
ms.date: 03/30/2017
ms.assetid: 8643a63d-a357-4c39-bd6c-cdfdf71e370e
ms.openlocfilehash: efc9512766d2a9cc814083ab632226d98917bf4e
ms.sourcegitcommit: 358a28048f36a8dca39a9fe6e6ac1f1913acadd5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/23/2020
ms.locfileid: "85245727"
---
# <a name="wcf-service-host-wcfsvchostexe"></a>WCF サービス ホスト (WcfSvcHost.exe)

Windows Communication Foundation (WCF) サービスホスト (WcfSvcHost.exe) を使用すると、Visual Studio デバッガー (F5) を起動して、実装したサービスを自動的にホストおよびテストすることができます。 その後、WCF テストクライアント (WcfTestClient.exe) または独自のクライアントを使用してサービスをテストし、潜在的なエラーを見つけて修正することができます。

## <a name="wcf-service-host"></a>WCF サービス ホスト

Wcf サービスホストは、WCF サービスプロジェクト内のサービスを列挙し、プロジェクトの構成を読み込み、検出された各サービスのホストをインスタンス化します。 このツールは、WCF サービステンプレートを使用して Visual Studio に統合され、プロジェクトのデバッグを開始すると呼び出されます。

Wcf サービスホストを使用すると、追加のコードを記述したり、開発中に特定のホストにコミットしたりすることなく、wcf サービスを (WCF サービスライブラリプロジェクト内で) ホストできます。

> [!NOTE]
> WCF サービスホストは部分信頼をサポートしていません。 部分信頼で WCF サービスを使用する場合は、サービスをビルドするために Visual Studio で WCF サービスライブラリプロジェクトテンプレートを使用しないでください。 代わりに、wcf 部分信頼がサポートされている web サーバーでサービスをホストできる WCF サービス Web サイトテンプレートを選択して、Visual Studio で新しい Web サイトを作成します。

## <a name="project-types-hosted-by-wcf-service-host"></a>WCF サービス ホストでホストされるプロジェクトの種類

Wcf サービスホストは、wcf サービスライブラリ、シーケンシャルワークフローサービスライブラリ、ステートマシンワークフローサービスライブラリ、および配信サービスライブラリという WCF サービスライブラリプロジェクトの種類をホストできます。 WCF サービスホストは、[**項目の追加**] 機能を使用してサービスライブラリプロジェクトに追加できるサービスをホストすることもできます。 これには、WCF サービス、WF ステートマシンサービス、WF シーケンシャルサービス、XAML WF ステートマシンサービス、および XAML WF シーケンシャルサービスが含まれます。

ただし、このツールでホストを構成することはできません。 このタスクでは、App.config ファイルを手動で編集する必要があります。 また、このツールでユーザー定義の構成ファイルを検証することはできません。

> [!CAUTION]
> WCF サービスホストは、この目的のために設計されていないため、運用環境でサービスをホストするためには使用しないでください。  WCF サービスホストは、このような環境の信頼性、セキュリティ、および管理容易性の要件をサポートしていません。 代わりに IIS を使用してください。IIS は、より高度な信頼性機能や監視機能を備えており、サービスをホストするのに適しています。 サービスの開発が完了したら、WCF サービスホストから IIS にサービスを移行する必要があります。

## <a name="scenarios-for-using-wcf-service-host-inside-visual-studio"></a>Visual Studio 内で WCF サービス ホストを使用するシナリオ

次の表に、[**コマンドライン引数**] ダイアログボックスのすべてのパラメーターを示します。このダイアログボックスは、Visual Studio の**ソリューションエクスプローラー**でプロジェクトを右クリックし、[**プロパティ**] を選択し、[**デバッグ**] タブを選択して [**プロジェクトの開始**] をクリックすると表示されます。 これらのパラメーターは、WCF サービスホストを構成するときに役立ちます。

|パラメーター|説明|
|---------------|-------------|
|`/client`|サービスのホストが開始された後に実行する実行可能ファイルへのパスを指定するオプション パラメーターです。 これにより、ホストの後に WCF テストクライアントが起動します。|
|`/clientArg`|カスタム クライアント アプリケーションに渡す引数として文字列を指定します。|
|`/?`|ヘルプ テキストを表示します。|

#### <a name="using-wcf-test-client"></a>WCF のテスト用クライアントの使用

新しい WCF サービスプロジェクトを作成し、F5 キーを押してデバッガーを起動すると、WCF サービスホストは、プロジェクト内で検出されたすべてのサービスのホストを開始します。 WCF テストクライアントが自動的に開き、構成ファイルで定義されているサービスエンドポイントの一覧が表示されます。 メイン ウィンドウでパラメーターをテストしたり、サービスを呼び出したりできます。

WCF テストクライアントが使用されていることを確認するには、Visual Studio の**ソリューションエクスプローラー**でプロジェクトを右クリックし、[**プロパティ**] を選択し、[**デバッグ**] タブを選択します。 [**プロジェクトの開始**] をクリックし、[**コマンドライン引数**] ダイアログボックスに次の内容が表示されていることを確認します。

`/client:WcfTestClient.exe`

#### <a name="using-a-custom-client"></a>カスタム クライアントの使用

カスタムクライアントを使用するには、Visual Studio の**ソリューションエクスプローラー**でプロジェクトを右クリックし、[**プロパティ**] を選択してから [**デバッグ**] タブを選択します。 [**プロジェクトの開始**] をクリックし、[ `/client` **コマンドライン引数**] ダイアログボックスでパラメーターを編集して、次の例に示すように、カスタムクライアントを指定します。

`/client:"path/CustomClient.exe"`

F5 キーを押してサービスを再び開始すると、デバッガーを起動すると、WCF サービスホストによって自動的にカスタムクライアントが開始されます。

`/clientArg:` パラメーターを使用して、カスタム クライアント アプリケーションに渡す引数として文字列を指定することもできます。以下に例を示します。

`/client:"path/CustomClient.exe" /clientArg:"arguments that are passed to Client"`

たとえば、配信サービス ライブラリ テンプレートを使用している場合は、次のコマンド ライン引数を使用できます。

`/client:iexplore.exe /clientArgs:http://localhost:8731/Design_Time_Addresses/Feed1/`

#### <a name="specifying-no-client"></a>クライアントを指定しない場合

WCF サービスをホストした後にクライアントを使用しないように指定するには、Visual Studio の**ソリューションエクスプローラー**でプロジェクトを右クリックし、[**プロパティ**] をクリックして、[**デバッグ**] タブをクリックします。 [**プロジェクトの開始**] をクリックし、[**コマンドライン引数**] ダイアログボックスを空白のままにします。

#### <a name="using-a-custom-host"></a>カスタム ホストの使用

カスタムホストを使用するには、Visual Studio の**ソリューションエクスプローラー**でプロジェクトを右クリックし、[**プロパティ**] を選択し、[**デバッグ**] タブを選択します。 [**外部プログラムの開始**] をクリックし、カスタムホストへの完全なパスを入力します。 [**コマンドライン引数**] ダイアログボックスを使用して、ホストに渡す引数を指定することもできます。

## <a name="wcf-service-host-user-interface"></a>WCF サービス ホストのユーザー インターフェイス

(Visual Studio 内で F5 キーを押して) 最初に WCF サービスホストを呼び出すと、[ **Wcf サービスホスト**] ウィンドウが自動的に開きます。 WCF サービスホストが実行されている場合、プログラムのアイコンが通知領域に表示されます。 アイコンをダブルクリックして、[ **WCF サービスホスト**] ウィンドウを開きます。

サービスホスティング中にエラーが発生すると、[WCF サービスホスト] ダイアログボックスが開き、関連する情報が表示されます。

**WCF サービスホスト**のメインウィンドウには、次の2つのメニューがあります。

- **File**: **Close**および**Exit**コマンドが含まれています。 [**閉じる**] をクリックすると、[ **WCF サービスホスト**] ダイアログボックスが閉じますが、サービスは引き続きホストされます。 [**終了**] をクリックすると、WCF サービスホストもシャットダウンされます。 ホストされているサービスもすべて停止します。

- **Help**: バージョン情報が含まれている**About**コマンドが含まれています。 ヘルプファイルを開くことができる**ヘルプ**コマンドも含まれています。

メインの [ **WCF サービスホスト**] ウィンドウには、次の2つの領域があります。

- 最初の領域は**Service**です。 この領域には、すべてのサービスの基本情報が一覧表示されます。 具体的には、次の情報が含まれています。

  - **サービス**: すべてのサービスが一覧表示されます。

  - **状態**: サービスの状態を一覧表示します。 有効な値は、"開始"、"停止"、および "エラー" です。

  - [**メタデータアドレス**: サービスのメタデータアドレスを表示します。

- 2つ目の領域は**追加情報**です。 **サービスエリアで**特定のサービスラインが選択されている場合に、サービスの状態の詳細な説明が表示されます。 状態が "エラー" の場合は、完全なエラー メッセージを画面上で確認できます。

## <a name="stopping-wcf-service-host"></a>WCF サービス ホストの停止

WCF サービスホストは、次の4つの方法でシャットダウンできます。

- Visual Studio でデバッグセッションを停止します。

- [ **WCF サービスホスト**] ウィンドウの [**ファイル**] メニューから [**終了**] を選択します。

- システム通知領域で、WCF サービスホストトレイアイコンのコンテキストメニューから [**終了**] を選択します。

- WCF テストクライアントが使用されている場合は、終了します。

## <a name="using-service-host-without-administrator-privilege"></a>管理特権を必要としないサービス ホストの使用

管理者特権を持たないユーザーが WCF サービスを開発できるようにするには、 http://+:8731/Design_Time_Addresses Visual Studio のインストール時に、名前空間 "" の ACL (Access Control リスト) が作成されます。 この ACL は (UI) に設定され、コンピューターにログオンしているすべての対話ユーザーが含まれます。 管理者は、この ACL のユーザーを追加または削除したり、追加のポートを開いたりすることができます。この ACL により、ユーザーは管理者特権を付与せずに、WCF サービスの自動ホスト (wcfSvcHost.exe) を使用できるようになります。

アクセス権を変更するには、管理者特権で Windows Vista の netsh.exe ツールを使用します。 netsh.exe の使用例を次に示します。

```console
netsh http add urlacl url=http://+:8001/MyService user=<domain>\<user>
```

netsh.exe の詳細については、「[Netsh.exe ツールとコマンドラインスイッチの使用方法](https://docs.microsoft.com/previous-versions/tn-archive/bb490939(v=technet.10))」を参照してください。

## <a name="see-also"></a>関連項目

- [WCF のテスト用クライアント (WcfTestClient.exe)](wcf-test-client-wcftestclient-exe.md)
