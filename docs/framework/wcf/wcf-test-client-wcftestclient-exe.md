---
title: WCF のテスト用クライアント (WcfTestClient.exe)
description: Wcf テストクライアントについて説明します。 wcf サービスホストと組み合わせると、シームレスなサービステストが提供されます。 クライアントテストの値を送信し、サービスの応答を表示します。
ms.date: 03/30/2017
ms.assetid: d4302855-677f-4640-aa90-c5d785d72fb7
ms.openlocfilehash: 4f636698c538809f89ee356159839a37b73adb57
ms.sourcegitcommit: 358a28048f36a8dca39a9fe6e6ac1f1913acadd5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/23/2020
ms.locfileid: "85245662"
---
# <a name="wcf-test-client-wcftestclientexe"></a>WCF のテスト用クライアント (WcfTestClient.exe)
Windows Communication Foundation (WCF) テスト用クライアント (WcfTestClient.exe) は、ユーザーがテストパラメーターを入力し、その入力をサービスに送信し、サービスから返される応答を表示できるようにする GUI ツールです。 WCF サービスホストと組み合わせると、シームレスなサービステストエクスペリエンスが提供されます。

通常、WCF テストクライアント (WcfTestClient.exe) は次の場所にあります。-Community は、インストールされている `C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\Common7\IDE` Visual Studio のレベルに応じて、"Enterprise"、"Professional"、または "community" のいずれかになります。

## <a name="scenarios-for-using-test-client"></a>テスト用クライアントを使用するシナリオ

以下のセクションでは、WCF テストクライアントを使用して開発プロセスを効率化できる最も一般的なシナリオについて説明します。

### <a name="inside-visual-studio"></a>Visual Studio 内

#### <a name="wcf-service-host-starts-wcf-test-client-with-a-single-service"></a>WCF サービス ホストが、1 つのサービスを使用する WCF のテスト用クライアントを開始する

新しい WCF サービスプロジェクトを作成し、F5 キーを押してデバッガーを起動した後、WCF サービスホストがプロジェクト内のサービスのホストを開始します。 次に、WCF テストクライアントが開き、構成ファイルで定義されているサービスエンドポイントの一覧が表示されます。 ユーザーは、パラメーターをテストしてサービスを呼び出すことができ、このプロセスを繰り返して、サービスのテストおよび検証を継続的に行うことができます。

#### <a name="wcf-service-host-starts-wcf-test-client-with-multiple-services"></a>WCF サービス ホストが、複数のサービスを使用する WCF のテスト用クライアントを開始する

また、WCF テストクライアントを使用して、複数のサービスを含むサービスプロジェクトをデバッグすることもできます。 WCF テストクライアントを開くと、プロジェクト内のサービスの一覧が自動的に反復処理され、テストのために開かれます。

### <a name="outside-visual-studio"></a>Visual Studio の外部

また、Visual Studio の外部で WCF テストクライアント (WcfTestClient.exe) を呼び出して、インターネット上の任意のサービスをテストすることもできます。 このツールを見つけるには、次の場所に移動します。

`C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\Common7\IDE`(コンピューターにインストールされている Visual Studio のレベルによっては、"Enterprise"、"Professional"、"Community" のいずれかになります)。

ツールを使用するには、ファイル名をダブルクリックしてこの場所からツールを開くか、コマンド ラインからツールを起動します。

WCF テストクライアントは、コマンドライン引数として任意の数の Uri を受け取ります。  これらの引数には、テストできるサービスの URI を指定します。

`wcfTestClient.exe URI1 URI2 …`

WCF テストクライアントウィンドウが開いたら、[**ファイル**] [サービスの追加] の順にクリックし、 -> **Add Service**開くサービスのエンドポイントアドレスを入力します。

## <a name="wcf-test-client-user-interface"></a>WCF のテスト用クライアントのユーザー インターフェイス

WCF テストクライアントは、1つのサービスまたは複数のサービスで使用できます。

### <a name="service-operations"></a>サービス操作

WCF テストクライアントのメインウィンドウの左ペインには、使用可能なすべてのサービスと、それぞれのエンドポイントと操作が一覧表示されます。

操作をダブルクリックすると、その操作の名前が付いた新しいタブ内の右ペインで、操作の内容を表示できます。

左ペインには、クライアントの構成ファイルも表示されます。 いずれかの項目をダブルクリックすると、右ペインの新しいタブ付きウィンドウにファイルの内容が表示されます。

### <a name="entering-test-parameters"></a>テスト パラメーターの入力

テスト パラメーターを表示するには、右ペインで操作をダブルクリックして開きます。 既定では、パラメーターは**書式付き**ビューで表示されます。また、パラメーターに任意の値を入力して、サービスをテストできます。

メッセージの XML を表示するには、[ **xml**] をクリックします。 サービスに送信するには、[**呼び出し**] をクリックします。

データセットパラメーターの場合は、[.. **.** ] をクリックします。 [編集] の横にあるボタン.. **.** データグリッドを表示する新しいウィンドウで編集します。 [**データセットのコピー** ] ボタンと [**データセットの貼り付け**] ボタンの外観がわかります。 最初の編集時に DataSet オブジェクトのスキーマが不明の場合、DataGrid は空になります。 スキーマが同じ DataSet オブジェクトを DataGrid の現在のオブジェクトに貼り付ける必要があります  (貼り付け操作の前に、他の場所からスキーマをコピーする必要があることに注意してください)。[**データセットのコピー** ] ボタンをクリックして、将来使用するためにデータセットオブジェクトをコピーすることもできます。

サービスの応答がテスト パラメーターの下に表示されます。

> [!NOTE]
> 想定される戻り値が文字列の場合、入力が引用符で囲まれていなくても、結果は引用符で囲まれた文字列として表示されます。

サービスのコントラクトの作成時に特定の操作を一方向として指定した場合は、サービスの応答は表示されません。 メッセージが配信のキューに置かれると、メッセージが正常に送信されたことを通知するダイアログ ボックスがすぐに表示されます。

### <a name="session-support"></a>セッション サポート

サービス操作のタブで [**新しいプロキシを開始**する] チェックボックスをオンにすると、セッションのサポートを切り替えることができます。 既定では、このチェック ボックスはオフになります。

特定の操作 (または同じサービスエンドポイントの別の操作) に対してテストパラメーターを入力し、チェックボックスをオフにして [**呼び出し**] を複数回クリックすると、これらの操作は1つのプロキシを共有し、サービスの状態は複数の操作にわたって保持されます。

[**新しいプロキシを開始**する] チェックボックスがオンになっている場合は、**呼び出し**ごとに新しいプロキシが開始され、前のセッションシナリオが終了して、サービスの状態がリセットされます。

### <a name="editing-client-configuration"></a>クライアント構成の編集

WCF テストクライアントのメインウィンドウの左ペインには、クライアント構成ファイルが一覧表示されます。 いずれかの項目をダブルクリックすると、右ペインにファイルの内容が表示されます。

#### <a name="edit-with-service-configuration-editor"></a>サービス構成エディターを使用した編集

左側のウィンドウで [ **Config File** ] を右クリックし、コンテキストメニューの [ **Edit with svcconfigeditor.exe**] を選択します。 サービス構成エディターが起動し、クライアント構成の内容が表示されます。 このツール内で構成を編集して保存できます。

サービス構成エディターでファイルを保存した後、ファイルが外部で変更されたことを知らせる警告メッセージが WCF テストクライアントに表示され、再度読み込むかどうかを確認するメッセージが表示されます。

[**はい**] を選択した場合、[Client.dll.config] タブの構成コンテンツには、エディターで行った変更が反映されます。

[**いいえ**] を選択した場合、[Client.dll.config] タブの構成内容は変更されず、変更されたコンテンツはソースファイルに自動的に保存されます。

#### <a name="restore-to-default-configuration"></a>既定の構成への復元

すべての変更を取り消して、既定のクライアント構成に復元する場合は、左側のウィンドウで [ **Config File** ] を右クリックし、コンテキストメニューの [**既定の構成に復元**] を選択します。既定の構成値が読み込まれ、[Client.dll.config] タブの内容が復元されます。

#### <a name="validate-changes"></a>変更の検証

保存された変更が WCF テストクライアントに読み込まれるときに、WCF スキーマに対して構成が有効かどうかがチェックされます。 エラーが見つかった場合は、エラーの詳細を示すダイアログ ボックスが表示されます。

プロキシの生成中、バイナリのコンパイル中、またはサービスの呼び出し時に、編集をサポートするメニュー項目 ("Edit..."、"Restore..." など) は無効になります。 サービスの呼び出しは、更新された構成を WCF テストクライアントに読み込むときにも無効になります。

#### <a name="persist-client-configuration"></a>クライアント構成の保持

[**ツール** -> **オプション**] [ -> **クライアントの構成**] タブには、[**サービスの起動時に常に構成を再生成**する] オプションがあります。これは既定で有効になっています。 このオプションは、WCF テストクライアントがサービスを読み込むたびに、最新のサービスコントラクトとサービス App.config ファイルに基づいて構成ファイルを再生成することを指定します。

WCF サービスのクライアント構成を編集していて、この更新されたファイルを常に使用してサービスをデバッグする場合は、[**再生成**] オプションをオフにすることができます。 これにより、サービスを更新して WCF テストクライアントを再度開く場合でも、更新されたサービスに基づいて再生成されたファイルではなく、以前に更新した Client.dll.config ファイルが作成されます。

ただし、再生成されたプロキシとの一貫性を保つために、構成ファイルの編集が必要になる場合があります。 サービスを更新したことが原因で、再生成されたプロキシと構成ファイルが一致しなくなると、サービスを呼び出したときにエラーが発生します。

> [!CAUTION]
> 変更したクライアント構成ファイルを後で再利用することにした場合、該当するファイルは次の場所で見つけることができます。
>
> \Documents と Settings \\ [User Account] \My Documents\Test Client Projects.
>
> クライアント構成ファイルに格納されている更新された資格情報は、このフォルダーのアクセス制御リスト (ACL) によって保護されています。

### <a name="adding-removing-and-refreshing-services"></a>サービスの追加、削除、および更新

#### <a name="add-service"></a>Add Service (サービスの追加)

[**ファイル**] [サービスの追加] をクリックして -> **Add Service** 、WCF テストクライアントにサービスを追加します。 次に、追加するサービスの URI (エンドポイント アドレス) を入力する必要があります。 サービスのアドレスには、MEX アドレスまたは WSDL アドレスを指定できます。

[**最近使用**したサービス] サブメニューには、最近追加された10個のサービスのエンドポイントの一覧も表示されます。 これらのいずれかを選択すると、指定したサービスが WCF テストクライアントに追加されます。

また、サービスツリーの **[マイサービスプロジェクト**] のルートを右クリックし、[**サービスの追加**] を選択すると、同じ結果が得られます。

プロキシの生成中、バイナリのコンパイル中、またはサービスの呼び出し中は、サービスの追加をサポートするメニュー項目が無効になります。 また、サービスの呼び出しも無効になります。

#### <a name="remove-service"></a>サービスの削除

削除するサービスのサービスルートを右クリックし、[**サービスの削除**] を選択して、WCF テストクライアントからサービスを削除します。

プロキシの生成中、バイナリのコンパイル中、またはサービスの呼び出し中は、サービスの削除をサポートするメニュー項目が無効になります。 また、サービスの呼び出しも無効になります。

#### <a name="refresh-service"></a>サービスの更新

WCF テストクライアントの実行中にサービスに変更が加えられた場合に、そのサービスの WCF テストクライアントの実装が最新であることを確認するには、サービスのサービスルートを右クリックし、[**サービスの更新**] を選択します。 更新後、サービスの状態はリセットされます。

プロキシの生成中、バイナリのコンパイル中、またはサービスの呼び出し中は、サービスの更新をサポートするメニュー項目が無効になります。 また、サービスの呼び出しも無効になります。

## <a name="location-of-files-generated-by-the-test-client"></a>テスト クライアントが生成するファイルの場所

既定では、WCF テストクライアントは、生成されたクライアントコードと構成ファイルを "%Appdata%\local\temp\test client projects Client Projects" フォルダーに格納します。 このフォルダーは、WCF テストクライアントが終了した後に削除されます。 WCF テストクライアントで構成ファイルが変更され、[サービスの開始] オプションが無効になっているときに [**常に構成を再生成**する] が有効になっている場合、変更されたファイルは、"My Documents\Test Client Projects" の下の "CachedConfig" フォルダーにコピーされます。

また、コマンドラインで WCF テストクライアントを起動し、スイッチを使用して、 `/ProjectPath` 生成されたファイルを格納するための新しい目的のパスを指定するか、スイッチを使用して `/RestoreProjectPath` 既定の場所を復元することもできます。 構文は次のとおりです。

`wcfTestClient.exe /ProjectPath [desired location]`

このコマンドを実行しても、WCF テストクライアントは開かれません。 フォルダーの場所が変更されるだけです。 このコマンドは、WCF テストクライアントが実行されているかどうかにかかわらず実行できます。 新しい場所は、WCF テストクライアントの再起動時に適用されます。 場所情報は、レジストリ、または "%Appdata%\local\temp\test client projects Client Projects" フォルダー内の WcfTestClient.exe ファイルに保存できます。

## <a name="features-supported-by-wcf-test-client"></a>WCF のテスト用クライアントでサポートされる機能

WCF テストクライアントでサポートされている機能の一覧を次に示します。

- サービスの呼び出し : 要求/応答メッセージおよび一方向メッセージ

- バインディング : Svcutil.exe でサポートされるすべてのバインディング

- セッションの制御

- メッセージ コントラクト

- XML シリアル化

WCF テストクライアントでサポートされていない機能の一覧を次に示します。

- 型: <xref:System.IO.Stream>、<xref:System.ServiceModel.Channels.Message>、<xref:System.Xml.XmlElement>、<xref:System.Xml.XmlAttribute>、<xref:System.Xml.XmlNode>、<xref:System.Xml.Serialization.IXmlSerializable> インターフェイスを実装する型 (関連する <xref:System.Xml.Serialization.XmlSchemaProviderAttribute> 属性を含む)、<xref:System.Xml.Linq.XDocument> 型と <xref:System.Xml.Linq.XElement> 型、および ADO.NET <xref:System.Data.DataTable> 型。

- 双方向コントラクト

- トランザクション

- セキュリティ: CardSpace、証明書、およびユーザー名/パスワード。

- バインディング : WSFederationBinding、任意のコンテキスト バインディングおよび HTTPS バインディング、WebHttpBinding (JSON 応答メッセージ サポート)

## <a name="closing-wcf-test-client"></a>WCF のテスト用クライアントの終了

WCF テストクライアントは、次の方法で閉じることができます。

- **[ファイル]** メニューの **[終了]** をクリックします。 または、WCF テストクライアントのメインウィンドウで、[**閉じる**] をクリックします。 どちらのアクションも、wcf サービスの自動ホストをシャットダウンし、visual Studio によって WCF テストクライアントが起動された場合に Visual Studio のデバッグプロセスを停止します。

- 通知領域の [ **WCF サービスホスト**] アイコンを右クリックし、[終了] をクリックし**ます。** これにより、WCF サービスの自動ホストと WCF テストクライアントの両方がシャットダウンされ、Visual Studio のデバッグプロセスが停止します。

## <a name="see-also"></a>関連項目

- [WCF サービス ホスト (WcfSvcHost.exe)](wcf-service-host-wcfsvchost-exe.md)
