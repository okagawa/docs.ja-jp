---
title: ドキュメント間での既存のノードのコピー
ms.date: 03/30/2017
ms.technology: dotnet-standard
ms.assetid: 3caa78c1-3448-4b7b-b83c-228ee857635e
ms.openlocfilehash: 8ae7fd04e5c85e59ca9bd629c6957ad470d36b48
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/02/2020
ms.locfileid: "84289201"
---
# <a name="copying-existing-nodes-from-one-document-to-another"></a>ドキュメント間での既存のノードのコピー
**ImportNode** メソッドを使用すると、ある **XmlDocument** から別の XmlDocument へ、ノードまたはノードのサブツリー全体をコピーできます。 呼び出しから返されるノードは、ソース ドキュメントのノードのコピーであり、そこには属性値、ノード名、ノード型が含まれます。さらに、プレフィックス、ローカル名、名前空間 URI (Uniform Resource Identifier) など、名前空間に関連するすべての属性も含まれます。 ソース ドキュメントは変更されません。 インポートしたノードは、ノードを挿入するメソッドの 1 つを使用してツリーに追加する必要があります。  
  
 新しいドキュメントにノードを追加すると、その新しいドキュメントがそのノードを所有します。 これは、ノードが別のドキュメント フラグメントに作成される場合でも、各ノードの作成時には所有元のドキュメントが設定されるためです。 これは XML ドキュメント オブジェクト モデル (DOM) の要件であり、**XmlDocument** クラスの設計仕様です。 たとえば、**CreateElement** は、新しいノードを作成する唯一の手段です。  
  
 インポートされたノード型と *deep* パラメーターの値によって、必要に応じて追加情報がコピーされます。 XML では、あるドキュメントから別のドキュメントへ XML ソースまたは HTML ソースのフラグメントをコピーしたときに 2 つのドキュメントのドキュメント型定義 (DTD) が別々になることがありますが、このメソッドでは、その動作を再現しようとします。  
  
 インポートできるノードの型について、それぞれに固有の動作を次の表に示します。  
  
|ノード型|*deep* パラメーターが true|*deep* パラメーターが false|  
|---------------|------------------------------|-------------------------------|  
|XmlAttribute|<xref:System.Xml.XmlAttribute.Specified%2A> は XmlAttribute で **true** に設定されています。 ソース **XmlAttribute** の子孫は再帰的にインポートされます。結果として得られるノードは再アセンブルされ、対応するサブツリーが形成されます。|**XmlAttribute** ノードは常に子ノードと共にインポートされるため、XmlAttribute ノードには *deep* パラメーターは適用されません。|  
|XmlCDataSection|ノードをそのデータと共にコピーします。|ノードをそのデータと共にコピーします。|  
|XmlComment|ノードをそのデータと共にコピーします。|ノードをそのデータと共にコピーします。|  
|XmlDocumentFragment|ソース ノードの子孫が再帰的にインポートされます。結果として得られるノードは再アセンブルされ、対応するサブツリーが形成されます。|空の **XmlDocumentFragment** が作成されます。|  
|XmlDocumentType|ノードがデータと共にコピーされます。*|ノードがデータと共にコピーされます。*|  
|XmlElement|ソース要素の子孫が再帰的にインポートされます。結果として得られるノードは再アセンブルされ、対応するサブツリーが形成されます。 **注:** 既定の属性はコピーされません。 インポートされるドキュメントでこの要素名に対する既定の属性が定義されている場合は、それらが割り当てられます。|指定された属性ノードがソース要素からインポートされ、生成された **XmlAttribute** ノードが新しい要素に追加されます。 子孫ノードはコピーされません。 **注:** 既定の属性はコピーされません。 インポートされるドキュメントでこの要素名に対する既定の属性が定義されている場合は、それらが割り当てられます。|  
|XmlEntityReference|ソース ドキュメントとターゲット ドキュメントではエンティティの定義が異なる可能性があるため、このメソッドは **XmlEntityReference** ノードだけをコピーします。 置換テキストは含まれません。 インポート先のドキュメントに同じエンティティが定義されている場合は、その値が割り当てられます。|ソース ドキュメントとターゲット ドキュメントではエンティティの定義が異なる可能性があるため、このメソッドは **XmlEntityReference** ノードだけをコピーします。 置換テキストは含まれません。 インポート先のドキュメントに同じエンティティが定義されている場合は、その値が割り当てられます。|  
|XmlProcessingInstruction|インポートされたノードから、ターゲットおよびデータの値がコピーされます。|インポートされたノードから、ターゲットおよびデータの値がコピーされます。|  
|XmlText|ノードをそのデータと共にコピーします。|ノードをそのデータと共にコピーします。|  
|XmlSignificantWhitespace|ノードをそのデータと共にコピーします。|ノードをそのデータと共にコピーします。|  
|XmlWhitespace|ノードをそのデータと共にコピーします。|ノードをそのデータと共にコピーします。|  
|XmlDeclaration|インポートされたノードから、ターゲットおよびデータの値がコピーされます。|インポートされたノードから、ターゲットおよびデータの値がコピーされます。|  
|その他のすべてのノード型|これらのノード型はインポートできません。|これらのノード型はインポートできません。|  
  
> [!NOTE]
> DocumentType ノードはインポートできますが、1 つのドキュメントは 1 つの DocumentType しか持てません。 したがって、ドキュメント型をインポートした場合は、それをツリーに挿入する前に、ドキュメント内にドキュメント型がないことを確認する必要があります。 ノードの削除については、「[XML ドキュメントからのノード、コンテンツ、値の削除](removing-nodes-content-and-values-from-an-xml-document.md)」を参照してください。  
  
## <a name="see-also"></a>関連項目

- [XML ドキュメント オブジェクト モデル (DOM)](xml-document-object-model-dom.md)
