---
title: NET の安全なコーディング ガイドライン
description: で使用するコードを設計します。NET によって適用されるアクセス許可およびその他の強制により、悪意のあるコードがデータにアクセスしたり、他のアクションを実行したりすることを防止できます。
ms.date: 06/28/2018
helpviewer_keywords:
- managed wrapper to native code implementation
- secure coding
- reusable components
- library code that exposes protected resources
- code, security
- code security
- secure coding, options
- components [.NET], security
- code security, options
- security-neutral code
- security [.NET], coding guidelines
ms.assetid: 4f882d94-262b-4494-b0a6-ba9ba1f5f177
ms.openlocfilehash: 05f7e039ecdc0cd33baa015872924fb9e1f078aa
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/12/2020
ms.locfileid: "79187725"
---
# <a name="secure-coding-guidelines"></a>安全なコーディングガイドライン

エビデンスベース セキュリティとコード アクセス セキュリティは、セキュリティを実現するための強力で明示的なメカニズムを提供します。 ほとんどのアプリケーション コードは、.NET によって実装されたインフラストラクチャを使用できます。 場合によっては、アプリケーション特有の追加のセキュリティが必要になります。これは、セキュリティ システムを拡張するか、または新しい特有の方法を使用して構築されます。

NET が適用するアクセス許可やその他のコードの適用を使用して、悪意のあるコードが、悪意のあるコードから、不要な情報にアクセスしたり、その他の望ましくないアクションを実行したりすることを防ぐ必要があります。 また、信頼されるコードを使用するすべての想定されるシナリオで、セキュリティと使いやすさのバランスを取る必要があります。

この概要では、セキュリティ システムと連携するようコードを設計するさまざまな方法を説明します。

## <a name="securing-resource-access"></a>リソース アクセスのセキュリティ保護

コードを設計して作成する場合、作成元が不明なコードを使用したり呼び出したりする際は特に、コードがリソースに対して持つアクセス権の保護と制限を行う必要があります。 そのため、コードの安全性を確保するために次の点に注意します。

- コード アクセス セキュリティ (CAS) を使用しないでください。

- 部分的に信頼されたコードを使用しないでください。

- [部分的に信頼された呼び出し元を許可](xref:System.Security.AllowPartiallyTrustedCallersAttribute)する属性 (APTCA) を使用しないでください。

- .NET リモート処理を使用しないでください。

- 分散コンポーネント オブジェクト モデル (DCOM) を使用しないでください。

- バイナリ フォーマッタを使用しないでください。

コード アクセス セキュリティおよび透過的なコードは、部分的に信頼されたコードのセキュリティ境界としてサポートされていません。 発生元の不明なコードの読み込みと実行に関しては、他のセキュリティ対策を適切に導入することなく行わないようにしてください。 代わりのセキュリティ対策は次のとおりです。

- 仮想化

- AppContainers

- オペレーティング システム (OS) のユーザーおよびアクセス許可

- Hyper-V コンテナー

## <a name="security-neutral-code"></a>セキュリティに依存しないコード

セキュリティ中立なコードは、セキュリティ システムに対して明示的な操作を何も行いません。 これは何であれ自分が受け取ったアクセス許可を使用して動作します。 保護された操作に関連付けられたセキュリティ例外 (ファイルやネットワークの使用など) をキャッチできないアプリケーションでは、処理されない例外が発生する可能性がありますが、セキュリティに依存しないコードは依然として .NET のセキュリティ テクノロジを利用します。.

セキュリティ中立なライブラリは、理解しておくべき特別な特性を持っています。 ライブラリに、ファイルを使用する API 要素、またはアンマネージ コードを呼び出す API 要素が用意されている場合を考えます。 コードに対応するアクセス許可がない場合は、説明どおりに実行されません。 しかし、コードがアクセス許可を持っているとしても、そのコードを呼び出すアプリケーション コードが同じアクセス許可を持っていなければ、正しく機能しません。 呼び出し元のコードに適切なアクセス許可がない<xref:System.Security.SecurityException>場合は、コード アクセス セキュリティ スタック ウォークの結果として a が表示されます。

## <a name="application-code-that-isnt-a-reusable-component"></a>再利用可能なコンポーネントではないアプリケーション コード

コードが他のコードから呼び出されないアプリケーションの一部である場合、セキュリティは単純であり、特別なコーディングは必要ない可能性があります。 ただし、悪意のあるコードがそのコードを呼び出す可能性があることを忘れないでください。 悪意のあるコードによるリソースへのアクセスをコード アクセス セキュリティが阻止する可能性もありますが、機密情報を含んだフィールドやプロパティの値をそのようなコードが読み取ることも考えられます。

また、コードがインターネットやその他の信頼できないソースからのユーザー入力を受け付ける場合には、悪意のある入力にも注意する必要があります。

## <a name="managed-wrapper-to-native-code-implementation"></a>ネイティブ コード実装へのマネージ ラッパー

一般にこのシナリオは、何らかの有用な機能がネイティブ コードで実装されており、これをマネージド コードで利用したいというケースに該当します。 マネージド ラッパーは、プラットフォーム呼び出しか COM 相互運用を使用して簡単に作成できます。 ただしこの場合には、操作を成功させるために、ラッパーの呼び出し元がアンマネージ コードの権利を持っている必要があります。 既定のポリシーでは、イントラネットまたはインターネットからダウンロードされたコードがラッパーで動作しないことを意味します。

これらのラッパーを使用するすべてのアプリケーションにアンマネージ コードの権限を与える代わりに、ラッパー コードにのみこれらの権限を与える方がよいです。 基になる機能が何もリソースを公開しておらず、かつ実装も同様に安全である場合、ラッパーは、自分の権利をアサートしさえすれば、あらゆるコードが自分を通して呼び出しを行えるようにできます。 リソースが関係する場合のセキュリティ コーディングは、次のセクションで説明するライブラリ コードのケースと同じです。 ラッパーはこれらのリソースに対して呼び出し元を公開する可能性があるため、ネイティブ コードの安全性を慎重に確認する必要があり、その責任はラッパーにあります。

## <a name="library-code-that-exposes-protected-resources"></a>保護されたリソースを公開するライブラリ コード

次のアプローチは、セキュリティ コーディングに対して最も強力で危険な (誤った場合) です: ライブラリは、.NET クラスが強制するように、他のコードが他のコードからアクセスできない特定のリソースにアクセスするためのインターフェイスとして機能します。使用するリソースのアクセス許可。 どこでリソースを公開しようと、コードはまずそのリソースに適したアクセス許可を要求し (つまりセキュリティ チェックを実行しなければなりません)、それから通常は実際の操作を実行するための権利をアサートする必要があります。

## <a name="related-topics"></a>関連トピック

|タイトル|説明|
|-----------|-----------------|
|[状態データの保護](securing-state-data.md)|プライベート メンバーを保護する方法について説明します。|
|[セキュリティとユーザー入力](security-and-user-input.md)|ユーザー入力を受け取るアプリケーションのセキュリティ問題について説明します。|
|[セキュリティと競合状態](security-and-race-conditions.md)|コードで競合状態を回避する方法について説明します。|
|[セキュリティと実行時のコード生成](security-and-on-the-fly-code-generation.md)|動的なコードを生成するアプリケーションのセキュリティ問題について説明します。|
|[ロールベースのセキュリティ](role-based-security.md)|NET ロール ベースのセキュリティについて詳しく説明し、コードで使用する手順を示します。|
