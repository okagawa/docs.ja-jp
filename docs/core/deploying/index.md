---
title: アプリケーションの発行
description: .NET Core アプリケーションを発行する方法について説明します。 .NET Core では、プラットフォーム固有の、またはクロスプラットフォームのアプリを発行できます。 アプリは、自己完結型として、またはランタイム依存として発行できます。 各モードは、お客様のアプリをユーザーが実行する方法に影響を与えます。
ms.date: 04/01/2020
ms.openlocfilehash: a4e5f9fe048d40c751f582bd49732cb903202db4
ms.sourcegitcommit: 45cced471d59d5dac3f0c92abc9d4849716098a2
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/04/2020
ms.locfileid: "80665539"
---
# <a name="net-core-application-publishing-overview"></a>.NET Core アプリケーションの発行の概要

.NET Core を使用して作成したアプリケーションは、2 つの異なるモードで発行できます。モードは、お客様のアプリをユーザーが実行する方法に影響します。

ご自分のアプリを "*自己完結型*" として発行すると、.NET Core ランタイムとライブラリ、さらにご自分のアプリケーションとその依存関係を含むアプリケーションが生成されます。 そのアプリケーションのユーザーは、.NET Core ランタイムがインストールされていないコンピューター上でそれを実行することができます。

ご自分のアプリを "*ランタイム依存*" (旧称 *フレームワーク依存*) として発行すると、ご自分のアプリケーション自体とその依存関係のみを含むアプリケーションが生成されます。 そのアプリケーションのユーザーは、.NET Core ランタイムを個別にインストールする必要があります。

どちらの発行モードでも、既定ではプラットフォーム固有の実行可能ファイルが生成されます。 ランタイム依存のアプリケーションは、実行可能ファイルなしで作成できます。これらのアプリケーションは、クロスプラットフォームです。

実行可能ファイルが生成されるときに、ランタイム識別子 (RID) を使用してターゲット プラットフォームを指定できます。 RID の詳細については、「[.NET Core の RID カタログ](../rid-catalog.md)」を参照してください。

次の表に、SDK のバージョンごとに、アプリをランタイム依存として、または自己完結型として発行するために使用するコマンドをまとめます。

| 種類                                                                                 | SDK 2.1 | SDK 3.x | コマンド |
| -----------------------------------------------------------------------------------  | ------- | ------- | ------- |
| 現在のプラットフォーム用の[ランタイム依存の実行可能ファイル](#publish-runtime-dependent)。 |         | ✔️      | [`dotnet publish`](../tools/dotnet-publish.md) |
| 特定のプラットフォーム用の[ランタイム依存の実行可能ファイル](#publish-runtime-dependent)。  |         | ✔️      | [`dotnet publish -r <RID> --self-contained false`](../tools/dotnet-publish.md) |
| [ランタイム依存のクロスプラットフォーム バイナリ](#publish-runtime-dependent)。               | ✔️      | ✔️      | [`dotnet publish`](../tools/dotnet-publish.md) |
| [自己完結型の実行可能ファイル](#publish-self-contained)。                                | ✔️      | ✔️      | [`dotnet publish -r <RID>`](../tools/dotnet-publish.md) |

詳細については、[.NET Core dotnet publish コマンド](../tools/dotnet-publish.md)に関するページを参照してください。

## <a name="produce-an-executable"></a>実行可能ファイルを生成する

実行可能ファイルはクロスプラットフォームではありません。 これは、オペレーティング システムおよび CPU アーキテクチャに固有のものです。 ご自分のアプリを発行して実行可能ファイルを作成するとき、アプリを[自己完結型](#publish-self-contained)または[ランタイム依存](#publish-runtime-dependent)として発行することができます。 アプリを自己完結型として発行すると、そのアプリに .NET Core ランタイムが含められます。アプリのユーザーはアプリを実行する前に .NET Core のインストールについて心配する必要はありません。 ランタイム依存として発行されたアプリには、.NET Core ランタイムとライブラリは含められません。アプリとサードパーティの依存関係のみが含められます。

次のコマンドを実行すると、実行可能ファイルが生成されます。

| 種類                                                                                 | SDK 2.1 | SDK 3.x | コマンド |
| ------------------------------------------------------------------------------------ | ------- | ------- | ------- |
| 現在のプラットフォーム用の[ランタイム依存の実行可能ファイル](#publish-runtime-dependent)。 |         | ✔️      | [`dotnet publish`](../tools/dotnet-publish.md) |
| 特定のプラットフォーム用の[ランタイム依存の実行可能ファイル](#publish-runtime-dependent)。  |         | ✔️      | [`dotnet publish -r <RID> --self-contained false`](../tools/dotnet-publish.md) |
| [自己完結型の実行可能ファイル](#publish-self-contained)。                                | ✔️      | ✔️      | [`dotnet publish -r <RID>`](../tools/dotnet-publish.md) |

## <a name="produce-a-cross-platform-binary"></a>クロスプラットフォーム バイナリを生成する

ご自分のアプリを *dll* ファイルの形式で [ランタイム依存](#publish-runtime-dependent)として発行すると、クロスプラットフォーム バイナリが作成されます。 *dll* ファイルには、プロジェクトに基づいて名前が付けられます。 たとえば、**word_reader** という名前のアプリがある場合、*word_reader.dll* という名前のファイルが作成されます。 この方法で発行されたアプリは、`dotnet <filename.dll>` コマンドを使用して実行され、任意のプラットフォームで実行できます。

ターゲットとなる .NET Core ランタイムが既にインストールされていれば、クロスプラットフォーム バイナリを任意のオペレーティング システムで実行できます。 ターゲットとなる .NET Core ランタイムがインストールされていない場合、アプリがロール フォワードするように構成されていれば、より新しいランタイムを使用してアプリを実行することができます。 詳細については、[ランタイム依存のアプリのロールフォワード](../versions/selection.md#framework-dependent-apps-roll-forward)に関するページを参照してください。

次のコマンドでは、クロスプラットフォーム バイナリが生成されます。

| 種類                                                                                 | SDK 2.1 | SDK 3.x | コマンド |
| -----------------------------------------------------------------------------------  | ------- | ------- | ------- |
| [ランタイム依存のクロスプラットフォーム バイナリ](#publish-runtime-dependent)。               | ✔️      | ✔️      | [`dotnet publish`](../tools/dotnet-publish.md) |

## <a name="publish-runtime-dependent"></a>ランタイム依存の発行

ランタイム依存として発行されたアプリはクロスプラットフォームであり、.NET Core ランタイムは含まれていません。 アプリのユーザーは、.NET Core ランタイムをインストールする必要があります。

アプリをランタイム依存として発行すると、[クロスプラットフォーム バイナリ](#produce-a-cross-platform-binary)が *dll* ファイルとして生成されるほか、現在ご利用のプラットフォームをターゲットとする[プラットフォーム固有の実行可能ファイル](#produce-an-executable)が生成されます。 *dll* はクロスプラットフォームですが、実行可能ファイルはそうではありません。 たとえば、**word_reader** という名前のアプリを発行し、Windows をターゲットとすると、*word_reader.exe* 実行可能ファイルが *word_reader.dll* と共に作成されます。 Linux または macOS をターゲットとすると、*word_reader* 実行可能ファイルが *word_reader.dll* と共に作成されます。 RID の詳細については、「[.NET Core の RID カタログ](../rid-catalog.md)」を参照してください。

> [!IMPORTANT]
> .NET Core SDK 2.1 では、アプリをランタイム依存として発行しても、プラットフォーム固有の実行可能ファイルは生成されません。

アプリのクロスプラットフォーム バイナリは、`dotnet <filename.dll>` コマンドを使用して実行でき、任意のプラットフォームで実行できます。 プラットフォーム固有の実装を含む NuGet パッケージがアプリで使用される場合、すべてのプラットフォームの依存関係が、アプリと共に publish フォルダーにコピーされます。

特定のプラットフォーム用の実行可能ファイルを作成するには、`-r <RID> --self-contained false` パラメーターを [`dotnet publish`](../tools/dotnet-publish.md) コマンドに渡します。 `-r` パラメーターを省略すると、現在のプラットフォーム用の実行可能ファイルが作成されます。 ターゲットとするプラットフォーム用のプラットフォーム固有の依存関係が含まれている NuGet パッケージはいずれも、publish フォルダーにコピーされます。

### <a name="advantages"></a>長所

- **小規模な展開**\
ご自分のアプリとその依存関係のみが配布されます。 .NET Core ランタイムとライブラリはユーザーによってインストールされ、そのランタイムはすべてのアプリで共有されます。

- **クロスプラットフォーム**\
ご自分のアプリと任意の NET ベースのライブラリは、他のオペレーティング システムでも実行されます。 ご自分のアプリに対してターゲット プラットフォームを定義する必要はありません。 .NET ファイル形式の詳細については、「[.NET アセンブリ ファイルの形式](../../standard/assembly/file-format.md)」を参照してください。

- **パッチが適用された最新のランタイムを使用する**\
アプリでは、ターゲット システムにインストールされている最新のランタイム (.NET Core のターゲットとなる major-minor ファミリ内の) が使用されます。 これは、パッチが適用された最新バージョンの .NET Core ランタイムが自動的に使用されることを意味します。 この既定の動作はオーバーライドできます。 詳細については、[ランタイム依存のアプリのロールフォワード](../versions/selection.md#framework-dependent-apps-roll-forward)に関するページを参照してください。

### <a name="disadvantages"></a>短所

- **ランタイムを事前にインストールする必要がある**\
ご自分のアプリを実行できるのは、このアプリでターゲットとされる .NET Core のバージョンがホスト システムに既にインストールされている場合のみです。 アプリで特定のバージョンの .NET Core が必要とされる場合、または新しいバージョンの .NET Core が許可される場合は、アプリのロール フォワード動作を構成することができます。 詳細については、[ランタイム依存のアプリのロールフォワード](../versions/selection.md#framework-dependent-apps-roll-forward)に関するページを参照してください。

- **.NET Core が変更される可能性がある**\
.NET Core ランタイムとライブラリは、アプリが実行されているコンピューター上で更新される可能性があります。 まれなケースとして、それにより、ほとんどのアプリで使用されている .NET Core ライブラリを使用すると、ご自分のアプリの動作が変わる場合があります。 より新しいバージョンの .NET Core をご自分のアプリで使用する方法を構成できます。 詳細については、[ランタイム依存のアプリのロールフォワード](../versions/selection.md#framework-dependent-apps-roll-forward)に関するページを参照してください。

次の欠点は、.NET Core 2.1 SDK にのみ適用されます。

- **`dotnet` コマンドを使用してアプリを起動する**\
お客様のアプリを起動するために、ユーザーは `dotnet <filename.dll>` コマンドを実行する必要があります。 .NET Core 2.1 SDK では、アプリがランタイム依存として発行される場合、プラットフォーム固有の実行可能ファイルは生成されません。

### <a name="examples"></a>使用例

アプリをクロスプラットフォーム ランタイム依存として発行します。 現在ご利用のプラットフォームをターゲットとする実行可能ファイルが *dll* ファイルと共に作成されます。

```dotnet
dotnet publish
```

アプリをクロスプラットフォーム ランタイム依存として発行します。 Linux 64 ビットの実行可能ファイルが *dll* ファイルと共に作成されます。 このコマンドは .NET Core SDK 2.1 では機能しません。

```dotnet
dotnet publish -r linux-x64 --self-contained false
```

## <a name="publish-self-contained"></a>自己完結型の発行

自己完結型としてご自分のアプリを発行すると、プラットフォーム固有の実行可能ファイルが生成されます。 output publishing フォルダーには、.NET Core ライブラリやターゲット ランタイムなど、アプリのすべてのコンポーネントが格納されます。 このアプリは他の .NET Core アプリから分離されていて、ローカルにインストールされた共有ランタイムを使用しません。 お客様のアプリのユーザーは、.NET Core のダウンロードもインストールも行う必要がありません。

指定したターゲット プラットフォームに対して実行可能バイナリが生成されます。 たとえば、**word_reader** という名前のアプリを持っていて、Windows 用に自己完結型の実行可能ファイルを発行する場合、*word_reader.exe* ファイルが作成されます。 Linux または macOS 用に発行する場合は、*word_reader* ファイルが作成されます。 ターゲットのプラットフォームおよびアーキテクチャは、[`dotnet publish`](../tools/dotnet-publish.md) コマンドの `-r <RID>` パラメーターを使用して指定します。 RID の詳細については、「[.NET Core の RID カタログ](../rid-catalog.md)」を参照してください。

プラットフォーム固有の依存関係を含む NuGet パッケージなど、プラットフォーム固有の依存関係がアプリにある場合、それらはアプリと共に publish フォルダーにコピーされます。

### <a name="advantages"></a>長所

- **.NET Core バージョンの制御**\
ご自分のアプリと共に展開する .NET Core のバージョンを制御できます。

- **プラットフォーム固有のターゲット設定**\
プラットフォームごとにご自分のアプリを発行する必要があるため、アプリが実行される場所を把握できます。 .NET Core に新しいプラットフォームが導入された場合、そのプラットフォームをターゲットとするバージョンをお客様がリリースするまで、ユーザーはそのプラットフォームでお客様のアプリを実行できません。 ユーザーが新しいプラットフォームでアプリを実行する前に、アプリに互換性の問題がないかテストできます。

### <a name="disadvantages"></a>短所

- **大規模な展開**\
アプリには .NET Core ランタイムとアプリのすべての依存関係が含まれているため、必要とされるダウンロード サイズとハード ドライブの容量は [ランタイム依存](#publish-runtime-dependent)のバージョンよりも大きくなります。

  > [!TIP]
  > .NET Core の ["*グローバリゼーション インバリアント モード*"](https://github.com/dotnet/runtime/blob/master/docs/design/features/globalization-invariant-mode.md) を使用することで、Linux システムでの展開のサイズを約 28 MB 小さくすることができます。 これにより、[インバリアント カルチャ](xref:System.Globalization.CultureInfo.InvariantCulture?displayProperty=nameWithType)のようなすべてのカルチャがアプリによって処理されるようになります。

- **.NET Core バージョンを更新するのが困難**\
.NET Core ランタイム (ご自分のアプリと共に配布される) は、ご自分のアプリの新しいバージョンをリリースすることによってのみアップグレードできます。 .NET Core ランタイムへのセキュリティ パッチとして、ご自分のアプリケーションの更新バージョンを提供する責任があります。

### <a name="examples"></a>使用例

アプリを自己完結型として発行します。 macOS 64 ビット実行可能ファイルが作成されます。

```dotnet
dotnet publish -r osx-x64
```

アプリを自己完結型として発行します。 Windows 64 ビット実行可能ファイルが作成されます。

```dotnet
dotnet publish -r win-x64
```

## <a name="see-also"></a>関連項目

- [.NET Core CLI を使用して .NET Core アプリを展開する](deploy-with-cli.md)
- [Visual Studio を使用して .NET Core アプリを展開する](deploy-with-vs.md)
- [パッケージ、メタパッケージ、フレームワーク](../packages.md)
- [.NET Core のランタイム識別子 (RID) のカタログ](../rid-catalog.md)
- [使用する .NET Core のバージョンを選択する](../versions/selection.md)
