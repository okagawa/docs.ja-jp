---
title: クラウド ネイティブのアプリケーションでのキャッシュ
description: クラウドネイティブアプリケーションでのキャッシュ戦略について説明します。
author: robvet
ms.date: 05/17/2020
ms.openlocfilehash: a109db59d7b2005ea97922eef07ae4869e4894a7
ms.sourcegitcommit: 27db07ffb26f76912feefba7b884313547410db5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/19/2020
ms.locfileid: "83614293"
---
# <a name="caching-in-a-cloud-native-app"></a>クラウドネイティブアプリでのキャッシュ

キャッシュの利点はよく理解されています。 この手法は、頻繁にアクセスされるデータをバックエンドデータストアから、アプリケーションの近くにある*高速ストレージ*に一時的にコピーすることによって機能します。 キャッシュは、多くの場合に実装されます。

- データは比較的静的なままです。
- 特にキャッシュの速度と比較して、データアクセスは低速です。
- データは高レベルの競合の影響を受けます。

## <a name="why"></a>なぜですか?

「 [Microsoft キャッシュのガイダンス](https://docs.microsoft.com/azure/architecture/best-practices/caching)」で説明されているように、キャッシュを使用すると、個々のマイクロサービスとシステム全体のパフォーマンス、スケーラビリティ、および可用性を向上させることができます。 これにより、データストアに対する大量の同時要求を処理する際の待機時間と競合が軽減されます。 データ量とユーザー数が増えるにつれて、キャッシュの利点が大きくなります。

キャッシュは、不変のデータまたは変更頻度の低いデータをクライアントが繰り返し読み取る場合に最も効果的です。 例としては、製品や価格情報などの参照情報や、構築するのにコストがかかる共有静的リソースなどがあります。

マイクロサービスはステートレスである必要がありますが、分散キャッシュは、必要に応じてセッション状態データへの同時アクセスをサポートできます。

また、繰り返し計算が行われないようにキャッシュを検討してください。 操作でデータを変換したり、複雑な計算を実行したりする場合は、後続の要求の結果をキャッシュします。

## <a name="caching-architecture"></a>キャッシュアーキテクチャ

クラウドネイティブアプリケーションは、通常、分散キャッシュアーキテクチャを実装します。 キャッシュは、マイクロサービスとは別に、クラウドベースの[バッキングサービス](./definition.md#backing-services)としてホストされます。 図5-15 にアーキテクチャを示します。

![クラウドネイティブアプリでのキャッシュ](media/caching-in-a-cloud-native-app.png)

**図 5-15**: クラウドネイティブアプリでのキャッシュ

前の図では、キャッシュがマイクロサービスに依存せず、共有されていることに注目してください。 このシナリオでは、キャッシュは[API ゲートウェイ](./front-end-communication.md)によって呼び出されます。 第4章で説明したように、ゲートウェイはすべての受信要求のフロントエンドとして機能します。 分散キャッシュは、可能な限りキャッシュされたデータを返すことによって、システムの応答性を高めます。 さらに、サービスからキャッシュを分離することで、増加したトラフィック要求に合わせてキャッシュを個別にスケールアップまたはスケールアウトすることができます。

前の図は、[キャッシュアサイドパターン](https://docs.microsoft.com/azure/architecture/patterns/cache-aside)と呼ばれる一般的なキャッシュパターンを示しています。 受信要求の場合は、最初にキャッシュに対してクエリを実行します (ステップ \# 1)。 見つかった場合は、すぐにデータが返されます。 データがキャッシュに存在しない場合 ([キャッシュミス](https://www.techopedia.com/definition/6308/cache-miss)とも呼ばれます)、ダウンストリームサービスのローカルデータベースから取得さ \# れます (ステップ 2)。 その後、後続の要求 (ステップ 3) のためにキャッシュに書き込ま \# れ、呼び出し元に返されます。 キャッシュされたデータを定期的に削除して、システムが適時かつ一貫した状態になるように注意する必要があります。

共有キャッシュが大きくなるにつれて、データを複数のノードにパーティション分割する方が有益な場合があります。 これにより、競合を最小限に抑えてスケーラビリティを向上させることができます。 多くのキャッシュサービスでは、ノードを動的に追加および削除したり、パーティション間でデータを再調整したりする機能がサポートされています。 このアプローチには、通常、クラスタリングが含まれます。 クラスタリングでは、シームレスな単一のキャッシュとして、フェデレーションノードのコレクションが公開されます。 ただし、内部的には、負荷を均等に分散する定義済みのディストリビューション戦略に従って、データがノード間で分散されます。

## <a name="azure-cache-for-redis"></a>Azure Cache for Redis

[Redis 用 Azure cache](https://azure.microsoft.com/services/cache/)は、セキュリティで保護されたデータキャッシュとメッセージングブローカーサービスであり、Microsoft によって完全に管理されています。 サービスとしてのプラットフォーム (PaaS) として使用され、データへの高スループットと待機時間の短いアクセスを提供します。 Azure の内部または外部のアプリケーションは、サービスにアクセスできます。

Redis サービス用の Azure キャッシュは、Azure データセンター間でホストされているオープンソースの Redis サーバーへのアクセスを管理します。 このサービスは、管理、アクセス制御、およびセキュリティを提供するファサードとして機能します。 サービスは、文字列、ハッシュ、リスト、セットなどの豊富なデータ構造のセットをネイティブでサポートしています。 アプリケーションが既に Redis を使用している場合、Redis の Azure Cache と同様に動作します。

Redis の Azure Cache は、単純なキャッシュサーバーを超えています。 マイクロサービスアーキテクチャを強化するためのさまざまなシナリオをサポートできます。

- メモリ内データストア
- 分散型の非リレーショナルデータベース
- メッセージブローカー
- 構成サーバーまたは検出サーバー
  
高度なシナリオでは、キャッシュされたデータのコピーを[ディスクに保存](https://docs.microsoft.com/azure/azure-cache-for-redis/cache-how-to-premium-persistence)できます。 致命的なイベントがプライマリキャッシュとレプリカキャッシュの両方を無効にすると、キャッシュは最新のスナップショットから再構築されます。

Azure Redis Cache は、いくつかの定義済みの構成と価格レベルで利用できます。  [Premium](https://docs.microsoft.com/azure/azure-cache-for-redis/cache-premium-tier-intro)レベルでは、クラスタリング、データの永続性、geo レプリケーション、仮想ネットワークの分離など、多くのエンタープライズレベルの機能が機能します。

>[!div class="step-by-step"]
>[前へ](relational-vs-nosql-data.md)
>[次へ](elastic-search-in-azure.md)
